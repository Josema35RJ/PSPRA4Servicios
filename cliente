import pysftp

class SftpClient:
    def __init__(self, hostname, username, password, port=22):
        self.hostname = '10.10.1.14'
        self.username = 'pi'
        self.password = 'raspberry'
        self.port = port
        self.connection = None  # Define el atributo connection en el método __init__

    def connect(self):
        cnopts = pysftp.CnOpts()
        cnopts.hostkeys = None  # Desactiva la comprobación de HostKey
        try:
            self.connection = pysftp.Connection(
                host=self.hostname,
                username=self.username,
                password=self.password,
                port=self.port,
                cnopts=cnopts
            )
            print(f"Conectado a {self.hostname} como {self.username}.")
        except Exception as err:
            print(f"No se pudo conectar al servidor: {err}")

    def disconnect(self):
        if self.connection:  # Comprueba si la conexión existe antes de intentar cerrarla
            self.connection.close()
            print(f"Desconectado del servidor {self.hostname}.")

# Crea una instancia del cliente Sftp y conéctate al servidor
client = SftpClient(hostname="10.10.1.14", username="username", password="password")
client.connect()

# Cuando hayas terminado, desconéctate del servidor
client.disconnect()
